---
phase: 03-daily-briefing-rate-limits
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - /home/ubuntu/.openclaw/cron/jobs.json
autonomous: true

must_haves:
  truths:
    - "Morning briefing fires at 7 AM PT with calendar, email, health, weather, and tasks sections"
    - "Briefing is delivered to Andy's Slack DM (D0AARQR0Y4V)"
    - "Email digest is merged into morning briefing (no separate 7:15 AM job)"
  artifacts:
    - path: "/home/ubuntu/.openclaw/cron/jobs.json"
      provides: "Expanded morning-briefing cron with 5-section prompt"
  key_links:
    - from: "morning-briefing cron systemEvent"
      to: "Oura SKILL.md health data"
      via: "agent reads health.db during briefing"
      pattern: "health_snapshots"
    - from: "morning-briefing cron systemEvent"
      to: "Gmail OAuth"
      via: "agent reads email during briefing"
      pattern: "unread emails"
---

<objective>
Expand the existing morning-briefing cron from calendar-only to a rich 5-section briefing (calendar, email, health, weather, tasks) and merge the separate email-digest cron into it.

Purpose: Give Andy a comprehensive daily briefing at 7 AM PT covering all key domains in one message, instead of fragmented calendar-only and email-only crons.
Output: Updated morning-briefing cron with rich system event prompt; email-digest-daily cron removed.
</objective>

<execution_context>
@/Users/andykaufman/.claude/get-shit-done/workflows/execute-plan.md
@/Users/andykaufman/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/phases/02-oura-ring-integration/02-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Expand morning briefing to 5 sections and merge email digest</name>
  <files>/home/ubuntu/.openclaw/cron/jobs.json</files>
  <action>
SSH to 100.72.143.9 and run these commands (use full path `/home/ubuntu/.npm-global/bin/openclaw`):

1. **Update the morning-briefing cron** with a rich 5-section system event (BR-01 through BR-06).

The existing morning-briefing ID is `863587f3-bb4e-409b-aee2-11fe2373e6e0`.

```
openclaw cron edit 863587f3-bb4e-409b-aee2-11fe2373e6e0 \
  --description "Rich daily briefing at 7 AM PT — calendar, email, health, weather, tasks" \
  --model sonnet \
  --timeout-seconds 120 \
  --wake now \
  --system-event "Morning Briefing — compile and send to Andy's DM D0AARQR0Y4V.

## 1. Calendar (BR-02)
Run: gog calendar list --account=theandykaufman@gmail.com --all --today --max=30
Format: all-day events grouped first, then timed events in chronological order, times in PT. Add brief prep notes for meetings (attendees, topic from title).

## 2. Email (BR-03)
Check unread emails from the last 24 hours. Summarize important ones (sender, subject, 1-line summary). Group by priority: action-required first, FYI second. Skip newsletters and marketing.

## 3. Health (BR-04)
Query /workspace/health.db: SELECT sleep_score, readiness_score, hrv_average, resting_heart_rate, activity_score FROM health_snapshots ORDER BY snapshot_date DESC LIMIT 1.
Report scores with brief interpretation (e.g., 'Sleep: 74 — fair, below your 80+ target'). If no data today, note when last snapshot was taken.

## 4. Weather (BR-05)
Fetch weather for Los Angeles, CA. Report current conditions (temp, description) and today's high/low/precipitation chance. Use curl to wttr.in/Los+Angeles?format=j1 for JSON weather data.

## 5. Tasks (BR-06)
Check memory for any open tasks, reminders, or follow-ups. List top 3-5 actionable items. If none found, say 'No pending tasks in memory.'

Format the briefing with clear section headers. Keep it concise but informative. Send as a single Slack message to D0AARQR0Y4V."
```

2. **Remove the separate email-digest-daily cron** (now merged into morning briefing):
```
openclaw cron rm email-digest-daily
```

3. **Verify**:
```
openclaw cron list
```
  </action>
  <verify>
Run on EC2:
- `openclaw cron list` shows morning-briefing with updated description
- `openclaw cron list` does NOT show email-digest-daily
- `cat ~/.openclaw/cron/jobs.json | python3 -c "import sys,json; jobs=json.load(sys.stdin)['jobs']; mb=[j for j in jobs if j.get('name')=='morning-briefing'][0]; print('Calendar' in mb['payload']['text'] and 'Email' in mb['payload']['text'] and 'Health' in mb['payload']['text'] and 'Weather' in mb['payload']['text'] and 'Tasks' in mb['payload']['text'])"` returns True
  </verify>
  <done>Morning briefing expanded to 5 sections (calendar, email, health, weather, tasks). Email digest merged in. Single comprehensive briefing at 7 AM PT targeting Andy's Slack DM. Model set to Sonnet for quality analysis. Timeout extended to 120s for multi-section work.</done>
</task>

</tasks>

<verification>
1. morning-briefing cron contains all 5 section keywords (Calendar, Email, Health, Weather, Tasks)
2. morning-briefing targets D0AARQR0Y4V (Andy's DM)
3. morning-briefing schedule unchanged (0 7 * * * @ America/Los_Angeles)
4. morning-briefing model set to sonnet
5. email-digest-daily cron removed
6. No duplicate briefing/digest crons
</verification>

<success_criteria>
- BR-01: Morning briefing cron fires at 7 AM PT via Slack DM
- BR-02: Calendar section with today's events and prep notes
- BR-03: Email section with unread summary grouped by priority
- BR-04: Health section with Oura sleep/readiness/HRV from health.db
- BR-05: Weather section with current conditions and forecast
- BR-06: Tasks section with open items from memory
</success_criteria>

<output>
After completion, create `.planning/phases/03-daily-briefing-rate-limits/03-02-SUMMARY.md`
</output>
