---
phase: 01-workspace-setup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - ~/clawd/agents/main/
  - ~/clawd/agents/landos/
  - ~/clawd/agents/rangeos/
  - ~/clawd/agents/ops/
  - ~/clawd/agents/main/memory/
  - ~/clawd/agents/landos/memory/
  - ~/clawd/agents/rangeos/memory/
  - ~/clawd/agents/ops/memory/
  - ~/clawd/shared/
  - ~/clawd/shared/memory/
  - ~/clawd/shared/AGENTS.md
  - ~/clawd/shared/memory/WORKING.md
autonomous: true

must_haves:
  truths:
    - "All 4 agent directories exist on EC2"
    - "Memory directories exist for each agent"
    - "Shared directory exists with AGENTS.md"
    - "WORKING.md exists in shared memory"
  artifacts:
    - path: "~/clawd/agents/main/"
      provides: "Main agent workspace"
    - path: "~/clawd/agents/landos/"
      provides: "LandOS agent workspace"
    - path: "~/clawd/agents/rangeos/"
      provides: "RangeOS agent workspace"
    - path: "~/clawd/agents/ops/"
      provides: "Ops agent workspace"
    - path: "~/clawd/shared/AGENTS.md"
      provides: "Multi-agent operating manual"
      contains: "## Agent Roster"
    - path: "~/clawd/shared/memory/WORKING.md"
      provides: "Active context file"
      contains: "## Current Focus"
  key_links:
    - from: "~/clawd/agents/*"
      to: "~/clawd/shared/"
      via: "relative path access"
---

<objective>
Create the multi-agent workspace directory structure on EC2 and initialize shared coordination files.

Purpose: Establish the foundation for 4 agents to operate with isolated workspaces and shared memory.
Output: Directory tree + AGENTS.md operating manual + WORKING.md active context file.
</objective>

<execution_context>
@/Users/andykaufman/.claude/get-shit-done/workflows/execute-plan.md
@/Users/andykaufman/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/REQUIREMENTS.md
@.planning/ROADMAP.md
@.planning/STATE.md

EC2 access: ssh ubuntu@100.72.143.9
Workspace root: ~/clawd/
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create directory structure on EC2</name>
  <files>
    ~/clawd/agents/main/
    ~/clawd/agents/landos/
    ~/clawd/agents/rangeos/
    ~/clawd/agents/ops/
    ~/clawd/agents/main/memory/
    ~/clawd/agents/landos/memory/
    ~/clawd/agents/rangeos/memory/
    ~/clawd/agents/ops/memory/
    ~/clawd/shared/
    ~/clawd/shared/memory/
  </files>
  <action>
SSH to EC2 (100.72.143.9) and create the complete directory structure:

```bash
ssh ubuntu@100.72.143.9 'mkdir -p ~/clawd/agents/{main,landos,rangeos,ops}/memory ~/clawd/shared/memory'
```

This creates:
- 4 agent directories: main, landos, rangeos, ops
- memory/ subdirectory in each agent directory
- shared/ directory with memory/ subdirectory

Verify all directories exist with correct structure.
  </action>
  <verify>
Run: `ssh ubuntu@100.72.143.9 'find ~/clawd -type d | sort'`
Expected output shows all 10 directories.
  </verify>
  <done>
All directories exist: agents/{main,landos,rangeos,ops}/memory and shared/memory
  </done>
</task>

<task type="auto">
  <name>Task 2: Create AGENTS.md operating manual</name>
  <files>~/clawd/shared/AGENTS.md</files>
  <action>
Create the shared AGENTS.md file that all agents reference for coordination protocols.

SSH to EC2 and create the file with this content:

```markdown
# Multi-Agent Operating Manual

## Agent Roster

| Agent ID | Name | Domain | Heartbeat Offset | Slack Channel |
|----------|------|--------|------------------|---------------|
| main | Andy | Coordinator | :00 | #clawdbot |
| landos | Scout | Land Investing | :02 | #land-ops |
| rangeos | Vector | UAS Operations | :04 | #range-ops |
| ops | Sentinel | Infrastructure | :06 | #ops |

## Communication Protocols

### Direct Messages
Use agent_messages table for async communication:
- `message_type`: task_handoff, question, update, alert
- Always mark messages as read when processed

### Task Handoffs
1. Create record in agent_tasks with target agent_id
2. Send message with message_type: task_handoff
3. Target agent picks up on next heartbeat

### Escalation
- Urgent issues: Send to #clawdbot (Andy/main)
- Infrastructure issues: Send to #ops (Sentinel)
- Domain issues: Send to domain channel

## Memory Architecture

### Per-Agent Memory
- Location: ~/clawd/agents/{agent_id}/memory/
- Use for: Agent-specific context, working notes, domain knowledge
- Cleanup: Agent maintains own memory

### Shared Memory
- Location: ~/clawd/shared/memory/
- WORKING.md: Current active project/focus
- Use for: Cross-agent context, handoff state

## Heartbeat Protocol

Every 15 minutes (staggered by 2 min):
1. Check agent_messages for unread messages
2. Check agent_tasks for assigned tasks
3. Execute pending work
4. Log activity to agent_activity table
5. Update memory files as needed

## Daily Standup (8 AM EST)

Sentinel (ops) agent aggregates:
1. Query agent_activity for last 24 hours
2. Summarize each agent's work
3. Post to #clawdbot
4. Identify blockers or coordination needs
```

Use heredoc via SSH:
```bash
ssh ubuntu@100.72.143.9 'cat > ~/clawd/shared/AGENTS.md << "EOF"
[content above]
EOF'
```
  </action>
  <verify>
Run: `ssh ubuntu@100.72.143.9 'head -20 ~/clawd/shared/AGENTS.md'`
Should show the header and agent roster table.
  </verify>
  <done>
AGENTS.md exists with agent roster, communication protocols, and memory architecture documented.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create WORKING.md active context file</name>
  <files>~/clawd/shared/memory/WORKING.md</files>
  <action>
Create the WORKING.md file in shared memory that tracks current active focus.

SSH to EC2 and create the file:

```markdown
# Active Context

## Current Focus

No active project - system initializing.

## Recent Handoffs

None yet.

## Blockers

None.

## Notes

- Multi-agent workspace initialized: [timestamp]
- Awaiting Phase 2: Gateway & Database configuration

---
*Last updated: [auto-update on agent activity]*
```

Use heredoc via SSH:
```bash
ssh ubuntu@100.72.143.9 'cat > ~/clawd/shared/memory/WORKING.md << "EOF"
[content above]
EOF'
```
  </action>
  <verify>
Run: `ssh ubuntu@100.72.143.9 'cat ~/clawd/shared/memory/WORKING.md'`
Should show the active context template.
  </verify>
  <done>
WORKING.md exists with current focus, recent handoffs, blockers, and notes sections.
  </done>
</task>

</tasks>

<verification>
After all tasks complete, verify the full structure:

```bash
ssh ubuntu@100.72.143.9 'find ~/clawd -type f -o -type d | sort'
```

Expected:
- 10 directories (4 agent dirs + 4 memory dirs + shared + shared/memory)
- 2 files (AGENTS.md, WORKING.md)

Requirements covered:
- WS-01: Agent directories created
- WS-02: Shared directory created
- WS-08: AGENTS.md operating manual
- WS-09: Memory directories per agent
- WS-10: Shared memory directory
- WS-11: WORKING.md active context
</verification>

<success_criteria>
- [ ] All 10 directories exist on EC2
- [ ] AGENTS.md contains agent roster table
- [ ] WORKING.md contains active context template
- [ ] No permission errors accessing directories
</success_criteria>

<output>
After completion, create `.planning/phases/01-workspace-setup/01-01-SUMMARY.md`
</output>
