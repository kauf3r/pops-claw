---
phase: 08-multi-agent-automation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - ~/.openclaw/cron/jobs.json
  - ~/clawd/agents/ops/STANDUP.md
autonomous: true

must_haves:
  truths:
    - "All 4 heartbeat crons fire at staggered offsets (:00/:02/:04/:06)"
    - "A daily-standup cron exists targeting Sentinel (ops) at 13:00 UTC"
    - "Standup prompt instructs Sentinel to query coordination.db and post to #ops"
  artifacts:
    - path: "~/.openclaw/cron/jobs.json"
      provides: "daily-standup cron job + verified heartbeat offsets"
      contains: "daily-standup"
    - path: "~/clawd/agents/ops/STANDUP.md"
      provides: "Standup aggregation instructions for Sentinel"
      contains: "coordination.db"
  key_links:
    - from: "daily-standup cron"
      to: "ops agent (Sentinel)"
      via: "agentTurn with agentId=ops"
      pattern: "agentId.*ops"
    - from: "Sentinel standup execution"
      to: "coordination.db"
      via: "sqlite3 query in /workspace/coordination.db"
      pattern: "coordination.db"
---

<objective>
Verify existing heartbeat cron staggering and create the daily standup cron for Sentinel.

Purpose: Phase 6 created 5 heartbeat crons but AA-01 requires verification of :00/:02/:04/:06 offsets. AA-02 requires a new daily standup cron at 13:00 UTC (8 AM EST) where Sentinel aggregates all agent activity from coordination.db and posts a summary to #ops.

Output: Verified heartbeat offsets, new daily-standup cron, STANDUP.md reference doc for Sentinel.
</objective>

<execution_context>
@/Users/andykaufman/.claude/get-shit-done/workflows/execute-plan.md
@/Users/andykaufman/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Phase 6 summaries — heartbeat crons and coordination DB setup
@.planning/phases/06-multi-agent-gateway/06-01-SUMMARY.md
@.planning/phases/06-multi-agent-gateway/06-02-SUMMARY.md

# Phase 3 summary — model routing and cron patterns
@.planning/phases/03-daily-briefing-rate-limits/03-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify heartbeat stagger offsets and fix if needed</name>
  <files>~/.openclaw/cron/jobs.json</files>
  <action>
SSH to EC2 (100.72.143.9) and audit existing heartbeat crons:

```bash
ssh -i ~/.ssh/clawdbot-key.pem ubuntu@100.72.143.9 '/home/ubuntu/.npm-global/bin/openclaw cron list --json'
```

Verify these 4 agent-specific heartbeats exist with staggered minute offsets:
- heartbeat-main-15m: minute :00 (or :00,:15,:30,:45)
- heartbeat-landos-15m: minute :02 (or :02,:17,:32,:47)
- heartbeat-rangeos-15m: minute :04 (or :04,:19,:34,:49)
- heartbeat-ops-15m: minute :06 (or :06,:21,:36,:51)

The 5th heartbeat (heartbeat-daily) runs once daily — that's separate, just confirm it exists.

**If offsets are wrong** (e.g., all at same minute), fix via `openclaw cron edit`:
```bash
openclaw cron edit heartbeat-main-15m --cron "*/15 * * * *"
openclaw cron edit heartbeat-landos-15m --cron "2-59/15 * * * *"
openclaw cron edit heartbeat-rangeos-15m --cron "4-59/15 * * * *"
openclaw cron edit heartbeat-ops-15m --cron "6-59/15 * * * *"
```

**If offsets are correct**, document the current cron expressions as evidence and move on.

Also verify all 4 have `model: haiku` (per Phase 3 decision). Exception: heartbeat-main-15m is systemEvent kind and cannot take model override — that's expected.
  </action>
  <verify>
Run `openclaw cron list --json` and confirm:
1. 4 heartbeat crons with 2-minute staggered offsets
2. All agentTurn heartbeats have model=haiku
3. heartbeat-daily exists
  </verify>
  <done>4 heartbeat crons firing at staggered offsets (:00/:02/:04/:06 within 15-min windows), all with haiku model (except systemEvent main)</done>
</task>

<task type="auto">
  <name>Task 2: Create daily standup cron and STANDUP.md for Sentinel</name>
  <files>~/.openclaw/cron/jobs.json, ~/clawd/agents/ops/STANDUP.md</files>
  <action>
**Step 1: Create STANDUP.md reference doc for Sentinel**

Write ~/clawd/agents/ops/STANDUP.md on EC2 with standup aggregation instructions. Use `tee` (NOT heredoc over SSH — causes hangs per MEMORY.md):

The STANDUP.md should contain:
- Purpose: daily standup aggregation from coordination.db
- SQL queries to run against /workspace/coordination.db:
  - Agent activity summary (last 24h): `SELECT agent_id, activity_type, COUNT(*) as count FROM agent_activity WHERE created_at > datetime('now', '-24 hours') GROUP BY agent_id, activity_type ORDER BY agent_id`
  - Recent task status: `SELECT agent_id, task_type, status, updated_at FROM agent_tasks WHERE updated_at > datetime('now', '-24 hours') ORDER BY updated_at DESC LIMIT 20`
  - Inter-agent messages: `SELECT from_agent, to_agent, subject, created_at FROM agent_messages WHERE created_at > datetime('now', '-24 hours') ORDER BY created_at DESC LIMIT 10`
- Output format: Post to #ops channel with sections:
  1. Agent Activity (who did what, how many heartbeats)
  2. Task Status (open/completed tasks per agent)
  3. Inter-Agent Comms (messages exchanged)
  4. Health Check (any agents with 0 activity = alert)
- Note: Use sqlite3-compat binary at /usr/bin/sqlite3 inside sandbox

**Step 2: Create the daily-standup cron job**

```bash
ssh -i ~/.ssh/clawdbot-key.pem ubuntu@100.72.143.9 '/home/ubuntu/.npm-global/bin/openclaw cron add daily-standup --cron "0 13 * * *" --agentId ops --model sonnet --message "## Daily Standup Aggregation\n\nRun the daily standup. Read /workspace/STANDUP.md for instructions.\n\nQuery /workspace/coordination.db using sqlite3 for all agent activity in the last 24 hours.\n\nFormat a summary with these sections:\n1. **Agent Activity** — heartbeat counts and activity types per agent\n2. **Task Status** — open and completed tasks\n3. **Inter-Agent Messages** — recent cross-agent communication\n4. **Health Check** — flag any agent with 0 activity as DOWN\n\nPost the formatted standup summary to the #ops Slack channel."'
```

Key parameters:
- Schedule: `0 13 * * *` (13:00 UTC = 8:00 AM EST)
- Agent: ops (Sentinel)
- Model: sonnet (more reasoning than haiku, standup needs aggregation)
- Kind: agentTurn (supports model override, unlike systemEvent)

If `openclaw cron add` doesn't support `--agentId`, use `--agent ops` or check `openclaw cron add --help` for the correct flag. If the message is too long for CLI, shorten to essentials — Sentinel has STANDUP.md for full instructions.
  </action>
  <verify>
1. Confirm STANDUP.md exists on EC2: `ssh ... ls -la ~/clawd/agents/ops/STANDUP.md`
2. Confirm cron created: `ssh ... openclaw cron list --json | grep daily-standup`
3. Verify cron schedule is `0 13 * * *` and agentId is `ops`
  </verify>
  <done>daily-standup cron exists at 13:00 UTC targeting Sentinel (ops), STANDUP.md deployed with coordination.db queries and output format</done>
</task>

</tasks>

<verification>
1. `openclaw cron list --json` shows 4 staggered heartbeats + daily-standup
2. Heartbeat offsets: main=:00, landos=:02, rangeos=:04, ops=:06
3. daily-standup: schedule=`0 13 * * *`, agentId=ops, model=sonnet
4. STANDUP.md exists at ~/clawd/agents/ops/STANDUP.md with coordination.db queries
</verification>

<success_criteria>
- AA-01 satisfied: 4 heartbeat crons verified with staggered offsets
- AA-02 satisfied: daily-standup cron at 13:00 UTC targeting Sentinel
- Sentinel has STANDUP.md reference for aggregation queries
</success_criteria>

<output>
After completion, create `.planning/phases/08-multi-agent-automation/08-01-SUMMARY.md`
</output>
