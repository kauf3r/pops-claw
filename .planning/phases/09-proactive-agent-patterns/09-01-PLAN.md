---
phase: 09-proactive-agent-patterns
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - /home/ubuntu/.openclaw/cron/jobs.json
  - /home/ubuntu/clawd/agents/main/MEETING_PREP.md
autonomous: true

must_haves:
  truths:
    - "A cron job runs every 15 minutes to scan for upcoming calendar events"
    - "15 minutes before a meeting, Bob sends context (attendees, prior notes, agenda) to Slack DM"
    - "Context-aware reminders fire based on calendar events combined with memory"
  artifacts:
    - path: "/home/ubuntu/clawd/agents/main/MEETING_PREP.md"
      provides: "Reference doc with calendar scanning, context assembly, and reminder instructions"
    - path: "/home/ubuntu/.openclaw/cron/jobs.json"
      provides: "meeting-prep-scan cron entry running every 15 minutes"
  key_links:
    - from: "cron/jobs.json (meeting-prep-scan)"
      to: "MEETING_PREP.md"
      via: "systemEvent text references MEETING_PREP.md for full instructions"
    - from: "MEETING_PREP.md"
      to: "gog calendar events"
      via: "Agent reads calendar via gog CLI during cron-triggered turn"
    - from: "MEETING_PREP.md"
      to: "Slack DM D0AARQR0Y4V"
      via: "Agent sends pre-meeting context and reminders via Slack"
---

<objective>
Create a proactive calendar-scanning cron job that sends pre-meeting context 15 minutes before events and fires context-aware reminders based on calendar + memory.

Purpose: Bob acts before being asked -- surfacing meeting prep, attendee context, and time-sensitive reminders without user prompting.
Output: meeting-prep-scan cron job + MEETING_PREP.md reference doc on EC2
</objective>

<execution_context>
@/Users/andykaufman/.claude/get-shit-done/workflows/execute-plan.md
@/Users/andykaufman/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-daily-briefing-rate-limits/03-02-SUMMARY.md
@.planning/phases/08-multi-agent-automation/08-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create MEETING_PREP.md reference doc for calendar scanning and context assembly</name>
  <files>/home/ubuntu/clawd/agents/main/MEETING_PREP.md</files>
  <action>
SSH to EC2 (100.72.143.9) and create ~/clawd/agents/main/MEETING_PREP.md with these sections:

## 1. Calendar Scan
- Run `gog calendar events --from now --to "+45 minutes"` to find events starting in the next 15-45 minutes
- If NO events found in that window, respond with a single line: "No upcoming meetings." and STOP (do not send any Slack message)
- If events found, proceed to context assembly for each event

## 2. Context Assembly (for each upcoming event)
For each event starting within 15-45 minutes:
- **Event details:** title, start time, end time, location/link
- **Attendees:** list all attendees from the event
- **Prior meetings:** search memory for previous interactions with attendees (use memory search)
- **Related emails:** run `gog gmail search "from:{attendee} OR to:{attendee}" --max 3` for key attendees
- **Notes/agenda:** check if event description contains agenda items

## 3. Context-Aware Reminders
After processing meetings, also check:
- Events starting in 1-2 hours that have preparation tasks mentioned in their description (e.g., "prepare slides", "review PR", "read document")
- Flag any event where the description mentions action items the user should complete before the meeting

## 4. Slack Delivery
Send assembled context to Andy's Slack DM (D0AARQR0Y4V):
- Format: bold event title, time, then bulleted context items
- Keep it concise -- 3-5 bullet points per meeting
- Only send if there are actual meetings or actionable reminders
- For prep-needed events (1-2 hours out), prefix with "Heads up:"

IMPORTANT: This runs in embedded mode (cron). Use HOST paths:
- Calendar: `gog calendar events` (available on host via PATH)
- Gmail: `gog gmail search` (available on host via PATH)
- Memory: Use built-in memory search tool
- Slack: Use built-in Slack messaging

Do NOT use /workspace/ paths. All file references must be absolute host paths.
  </action>
  <verify>SSH to EC2 and confirm file exists: `ls -la ~/clawd/agents/main/MEETING_PREP.md` and `wc -l ~/clawd/agents/main/MEETING_PREP.md` shows meaningful content (50+ lines)</verify>
  <done>MEETING_PREP.md deployed to agent workspace with calendar scan, context assembly, reminder, and Slack delivery sections</done>
</task>

<task type="auto">
  <name>Task 2: Create meeting-prep-scan cron job running every 15 minutes</name>
  <files>/home/ubuntu/.openclaw/cron/jobs.json</files>
  <action>
SSH to EC2 (100.72.143.9) and create the cron job:

```bash
/home/ubuntu/.npm-global/bin/openclaw cron add \
  --name "meeting-prep-scan" \
  --schedule "*/15 * * * *" \
  --agent main \
  --session main \
  --wake now \
  --system-event "Read /home/ubuntu/clawd/agents/main/MEETING_PREP.md and follow its instructions to scan for upcoming meetings and send prep context."
```

After creation, verify:
1. `openclaw cron list` shows meeting-prep-scan with `*/15 * * * *` schedule
2. Check jobs.json to confirm the entry has correct structure:
   - `wakeMode: "now"` (immediate activation, not next-heartbeat)
   - `payload.kind: "systemEvent"`
   - `schedule.expr: "*/15 * * * *"`
   - `agentId: "main"`

Note: systemEvent payloads do not support --model or --timeout overrides. Agent will use its default model (sonnet). This is fine since the task is lightweight (calendar query + Slack post).
  </action>
  <verify>SSH to EC2 and run `openclaw cron list | grep meeting-prep` to confirm job exists with correct schedule. Also verify with `cat ~/.openclaw/cron/jobs.json | python3 -c "import sys,json; jobs=json.load(sys.stdin); print([j['name'] for j in jobs if 'meeting' in j['name']])"` to confirm it's in jobs.json</verify>
  <done>meeting-prep-scan cron fires every 15 minutes, triggers Bob to scan calendar and send pre-meeting context + reminders to Slack DM</done>
</task>

</tasks>

<verification>
1. `openclaw cron list` shows meeting-prep-scan with */15 schedule
2. MEETING_PREP.md exists at ~/clawd/agents/main/ with all 4 sections
3. Cron entry has wakeMode=now and systemEvent payload referencing MEETING_PREP.md
4. Next run time is within 15 minutes of current time
</verification>

<success_criteria>
- PP-01 satisfied: Pre-meeting prep cron scans calendar every 15min, sends context 15min before events
- PP-03 satisfied: Context-aware reminders check for prep tasks in event descriptions and flag upcoming action items
- Established pattern: proactive calendar scanning via cron + reference doc
</success_criteria>

<output>
After completion, create `.planning/phases/09-proactive-agent-patterns/09-01-SUMMARY.md`
</output>
